{"remainingRequest":"/usr/vue/lezuro_all/node_modules/babel-loader/lib/index.js!/usr/vue/lezuro_all/node_modules/cache-loader/dist/cjs.js??ref--1-0!/usr/vue/lezuro_all/node_modules/vue-loader/lib/index.js??vue-loader-options!/usr/vue/lezuro_all/src/components/manager/ManagerHeader.vue?vue&type=script&lang=js","dependencies":[{"path":"/usr/vue/lezuro_all/src/components/manager/ManagerHeader.vue","mtime":1734419711515},{"path":"/usr/vue/lezuro_all/babel.config.js","mtime":1728542743944},{"path":"/usr/vue/lezuro_all/node_modules/cache-loader/dist/cjs.js","mtime":1728542746732},{"path":"/usr/vue/lezuro_all/node_modules/babel-loader/lib/index.js","mtime":1728543112262},{"path":"/usr/vue/lezuro_all/node_modules/cache-loader/dist/cjs.js","mtime":1728542746732},{"path":"/usr/vue/lezuro_all/node_modules/vue-loader/lib/index.js","mtime":1728542748492}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnSGVhZGVyQ29tcG9uZW50JywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNMb2dnZWRJbjogZmFsc2UsCiAgICAgIC8vIOuhnOq3uOyduCDsg4Htg5wKICAgICAgYWN0aXZlTWVudTogJycsCiAgICAgIC8vIO2YhOyerCDtmZzshLEg66mU64m0IO2VreuqqQogICAgICB1c2VyTmFtZTogJycsCiAgICAgIGNudDogMAogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICAvLyDroZzqt7jsnbgg7IOB7YOc66W8IO2ZleyduCAo7JiIOiDroZzsu6wg7Iqk7Yag66as7KeA7JeQ7IScIO2GoO2BsCDtmZXsnbgpCiAgICBjb25zdCBtYW5hZ2VyVG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgibWFuYWdlclRva2VuIik7CiAgICBjb25zb2xlLmxvZygibWFuYWdlclRva2VuIDogOiA6ICIsIG1hbmFnZXJUb2tlbik7CiAgICBpZiAobWFuYWdlclRva2VuKSB7CiAgICAgIHRoaXMuaXNMb2dnZWRJbiA9IHRydWU7CiAgICAgIC8vIGNvbnNvbGUubG9nKCJsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9naW5JbmZvJykgOiA6IDoiICxsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbG9naW5JbmZvJykpCiAgICAgIGNvbnN0IG1hbmFnZXJJbmZvID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbWFuYWdlckluZm8nKSk7CiAgICAgIGNvbnNvbGUubG9nKCJtYW5hZ2VyVG9rZW4gOiA6IDogIiwgbWFuYWdlckluZm8pOwogICAgICB0aGlzLmNoZWNrQXV0aChtYW5hZ2VySW5mby5pZCwgbWFuYWdlclRva2VuKTsKICAgICAgY29uc3QgaXNGaXJzdExvZ2luID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oImlzRmlyc3RMb2dpbiIpOwogICAgICBpZiAoaXNGaXJzdExvZ2luID09PSAidHJ1ZSIpIHsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiaXNGaXJzdExvZ2luIiwgImZhbHNlIik7IC8vIOyDiOuhnOqzoOy5qCDtm4Qg7ZSM656Y6re466W8IGZhbHNl66GcIOuzgOqyvQogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIHBhdGg6ICIvbWFuYWdlcmxvZ2luIgogICAgICB9KTsKICAgICAgdGhpcy5pc0xvZ2dlZEluID0gZmFsc2U7CiAgICB9CiAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgIC8vICAgICAgIHRoaXMubG9nT3V0KCk7IC8vIOuhnOq3uOyVhOybgyDrqZTshJzrk5wg7Zi47LacCiAgICAvLyAgICAgfSwgNjAgKiA2MCAqIDEwMDApOyAvLyAx7Iuc6rCEID0gNjDrtoQgKiA2MOy0iCAqIDEwMDDrsIDrpqzstIgKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGNoZWNrQXV0aChpZHgsIHRva2VucykgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KGBodHRwOi8vMTMuMTI0LjYyLjY4OjMwMDAvYXBpL2FkbWluaXN0cmF0b3JzLyR7aWR4fWAsIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW5zfWAKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmxvZygicmVzcG9uc2UgOiA6IDogOiAiLCByZXNwb25zZSk7CiAgICAgICAgLy8gdGhpcy5nZXRSZWZyZXNoVG9rZW4odG9rZW5zKQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIu2GoO2BsCDqsLHsi6Ag7JeQ65+sOiIsIGVycm9yKTsKICAgICAgICAvLyDsl6zquLDshJwg66as7ZSE66CI7IucIO2GoO2BsCDrsI8g7JeR7IS47IqkIO2GoO2BsCDsnqwg6rCx7IugCiAgICAgICAgdGhpcy5sb2dPdXQoKTsKICAgICAgICAvLyAgdGhpcy5nZXRSZWZyZXNoVG9rZW4oaWR4LHRva2VucykKICAgICAgICAvLyAgIC50aGVuKChkYXRhKSA9PiB7CiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKCLqsLHsi6DrkJwg642w7J207YSwOiIsIGRhdGEpOwogICAgICAgIC8vICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbWFuYWdlclRva2VuJywgZGF0YS50b2tlbik7fSk7CiAgICAgICAgLy8gICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJpc0ZpcnN0TG9naW4iLCAidHJ1ZSIpOyAKICAgICAgICAvLyAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKCiAgICAgICAgdGhyb3cgZXJyb3I7IC8vIOyXkOufrOulvCDtmLjstpztlZwg6rOz7Jy866GcIOuLpOyLnCDrjZjsp5AKICAgICAgfQogICAgfSwKICAgIHNldEFjdGl2ZU1lbnUobWVudSkgewogICAgICB0aGlzLmFjdGl2ZU1lbnUgPSBtZW51OyAvLyDtgbTrpq3tlZwg66mU64m0IO2VreuqqeydhCDtmZzshLHtmZQKICAgIH0sCiAgICBsb2dPdXQoKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJtYW5hZ2VyVG9rZW4iKTsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oIm1hbmFnZXJJbmZvIik7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgIH0sCiAgICBhc3luYyBnZXRSZWZyZXNoVG9rZW4oaWR4LCB0b2tlbnMpIHsKICAgICAgY29uc29sZS5sb2coIuydtOqxsO2DgOuCmOyalD8iICsgdG9rZW5zKTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldChgaHR0cDovLzEzLjEyNC42Mi42ODozMDAwL2FwaS92MS9hdXRoL3JlZnJlc2gvJHtpZHh9YCwgewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgICAgIC8vICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Rva2Vuc31gLAogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGNvbnNvbGUubG9nKCJyZXNwb25zZT8iLCBKU09OLnN0cmluZ2lmeShyZXNwb25zZSkpOwoKICAgICAgICAvLyBSZXNwb25zZSDsmIjsoJw6IAogICAgICAgIC8vIHsidG9rZW4iOiIuLi4iLCAicmVmcmVzaFRva2VuIjoiLi4uIiwgInRva2VuRXhwaXJlcyI6Li4ufQoKICAgICAgICAvLyDtlYTsmpTtlZwg642w7J207YSw66eMIOumrO2EtAogICAgICAgIGNvbnN0IHsKICAgICAgICAgIHRva2VuLAogICAgICAgICAgcmVmcmVzaFRva2VuLAogICAgICAgICAgdG9rZW5FeHBpcmVzCiAgICAgICAgfSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgY29uc29sZS5sb2coIuyDiOuhnOyatCDthqDtgbA6IiwgdG9rZW4pOwogICAgICAgIGNvbnNvbGUubG9nKCLsg4jroZzsmrQg66as7ZSE66CI7IucIO2GoO2BsDoiLCByZWZyZXNoVG9rZW4pOwogICAgICAgIGNvbnNvbGUubG9nKCLthqDtgbAg66eM66OMIOyLnOqwhDoiLCB0b2tlbkV4cGlyZXMpOwoKICAgICAgICAvLyDqsJ3ssrQg7ZiV7YOc66GcIOumrO2EtAogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0b2tlbiwKICAgICAgICAgIHJlZnJlc2hUb2tlbiwKICAgICAgICAgIHRva2VuRXhwaXJlcwogICAgICAgIH07CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigi7Yag7YGwIOqwseyLoCDsl5Drn6w6IiwgZXJyb3IpOwogICAgICAgIHRocm93IGVycm9yOyAvLyDsl5Drn6zrpbwg7Zi47Lac7ZWcIOqzs+ycvOuhnCDri6Tsi5wg642Y7KeQCiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"names":["axios","name","data","isLoggedIn","activeMenu","userName","cnt","mounted","managerToken","localStorage","getItem","console","log","managerInfo","JSON","parse","checkAuth","id","isFirstLogin","setItem","window","location","reload","$router","push","path","methods","idx","tokens","response","get","headers","error","logOut","setActiveMenu","menu","removeItem","getRefreshToken","stringify","token","refreshToken","tokenExpires"],"sources":["src/components/manager/ManagerHeader.vue"],"sourcesContent":["<template>\n  <header>\n    <div class=\"center\">\n    <!-- 로고 섹션 -->\n    <div class=\"logo-container\">\n      <img src=\"../../../img/lezuro-logo-white-2-3@2x.png\" alt=\"Logo\" class=\"logo-image\" />\n    </div>\n    <!-- 우측 메뉴 섹션 -->\n    <div class=\"menu-container\">\n      <div class=\"menu-link\" @click=\"$router.push('/')\">\n        <img src=\"../../../img/Vector-2.png\" alt=\"\" >\n        홈페이지</div>\n      <span class=\"separator\">|</span>\n      <div class=\"menu-link\" @click=\"logOut()\">로그아웃</div>\n    </div>\n    </div>\n  </header>\n</template>\n\n<script>\nimport axios from 'axios';\n\n\nexport default {\n  name: 'HeaderComponent',\n  data() {\n    return {\n      isLoggedIn: false, // 로그인 상태\n      activeMenu: '', // 현재 활성 메뉴 항목\n      userName : '',\n      cnt : 0\n    };\n  },\n  mounted() {\n    // 로그인 상태를 확인 (예: 로컬 스토리지에서 토큰 확인)\n    const managerToken = localStorage.getItem(\"managerToken\");\n    \n    console.log(\"managerToken : : : \" , managerToken)\n     \n    if(managerToken){\n    \n      this.isLoggedIn =  true;\n      // console.log(\"localStorage.getItem('loginInfo') : : :\" ,localStorage.getItem('loginInfo'))\n      const managerInfo = JSON.parse(localStorage.getItem('managerInfo'));\n      console.log(\"managerToken : : : \" , managerInfo)      \n      this.checkAuth(managerInfo.id, managerToken)\n      const isFirstLogin = localStorage.getItem(\"isFirstLogin\");\n      if (isFirstLogin === \"true\") {\n        localStorage.setItem(\"isFirstLogin\", \"false\"); // 새로고침 후 플래그를 false로 변경\n        window.location.reload();\n      }\n    }else{\n      this.$router.push({path:\"/managerlogin\"})\n      this.isLoggedIn =  false;\n    }\n    // setTimeout(() => {\n    //       this.logOut(); // 로그아웃 메서드 호출\n    //     }, 60 * 60 * 1000); // 1시간 = 60분 * 60초 * 1000밀리초\n    \n    \n\n  },\n  methods: {\n    async checkAuth(idx, tokens){\n    \n    try {\n          const response = await axios.get(`http://13.124.62.68:3000/api/administrators/${idx}`, {\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': `Bearer ${tokens}`,\n            },\n          });\n          console.log(\"response : : : : \" , response)\n          // this.getRefreshToken(tokens)\n\n        } catch (error) {\n          console.error(\"토큰 갱신 에러:\", error);\n          // 여기서 리프레시 토큰 및 엑세스 토큰 재 갱신\n          this.logOut();\n          //  this.getRefreshToken(idx,tokens)\n          //   .then((data) => {\n          //     console.log(\"갱신된 데이터:\", data);\n          //     localStorage.setItem('managerToken', data.token);});\n          //     localStorage.setItem(\"isFirstLogin\", \"true\"); \n            //   window.location.reload();\n          \n          throw error; // 에러를 호출한 곳으로 다시 던짐\n        }\n   },\n    setActiveMenu(menu) {\n      this.activeMenu = menu; // 클릭한 메뉴 항목을 활성화\n    },\n    logOut(){\n      \n      localStorage.removeItem(\"managerToken\");\n      localStorage.removeItem(\"managerInfo\");\n      window.location.reload();\n    },\n    async getRefreshToken(idx,tokens){\n      console.log(\"이거타나요?\"+ tokens)\n      try {\n          const response = await axios.get(`http://13.124.62.68:3000/api/v1/auth/refresh/${idx}`, {\n            headers: {\n              'Content-Type': 'application/json',\n              // 'Authorization': `Bearer ${tokens}`,\n            },\n          });\n          console.log(\"response?\" , JSON.stringify(response))\n\n          // Response 예제: \n          // {\"token\":\"...\", \"refreshToken\":\"...\", \"tokenExpires\":...}\n\n          // 필요한 데이터만 리턴\n          const { token, refreshToken, tokenExpires } = response.data;\n\n          console.log(\"새로운 토큰:\", token);\n          console.log(\"새로운 리프레시 토큰:\", refreshToken);\n          console.log(\"토큰 만료 시간:\", tokenExpires);\n\n          // 객체 형태로 리턴\n          return { token, refreshToken, tokenExpires };\n\n        } catch (error) {\n          console.error(\"토큰 갱신 에러:\", error);\n          throw error; // 에러를 호출한 곳으로 다시 던짐\n        }\n    },\n  }\n};\n</script>\n\n<style scoped>\nheader {\n  height: 90px;\n  background-color: #333;\n}\n.center{  display: flex;\n  align-items: center;\n    padding: 25px 41px;\n  justify-content: space-between;}\n.logo-container {\n  display: flex;\n  align-items: center;\n  margin-left:76px;\n}\n\n.logo-image {\n    width:126px;\n}\n\n.logo-text {\n  color: white;\n  margin-left: 10px;\n}\n\n.menu-container {\n  display: flex;\n  align-items: center;\n  color: white;\n}\n\n.menu-link {\n  color: white;\n  text-decoration: none;\n  margin: 0 15px;\n}\n\n.separator {\n  color: white;\n}\n</style>\n"],"mappings":";AAoBA,OAAAA,KAAA;AAGA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,UAAA;MAAA;MACAC,UAAA;MAAA;MACAC,QAAA;MACAC,GAAA;IACA;EACA;EACAC,QAAA;IACA;IACA,MAAAC,YAAA,GAAAC,YAAA,CAAAC,OAAA;IAEAC,OAAA,CAAAC,GAAA,wBAAAJ,YAAA;IAEA,IAAAA,YAAA;MAEA,KAAAL,UAAA;MACA;MACA,MAAAU,WAAA,GAAAC,IAAA,CAAAC,KAAA,CAAAN,YAAA,CAAAC,OAAA;MACAC,OAAA,CAAAC,GAAA,wBAAAC,WAAA;MACA,KAAAG,SAAA,CAAAH,WAAA,CAAAI,EAAA,EAAAT,YAAA;MACA,MAAAU,YAAA,GAAAT,YAAA,CAAAC,OAAA;MACA,IAAAQ,YAAA;QACAT,YAAA,CAAAU,OAAA;QACAC,MAAA,CAAAC,QAAA,CAAAC,MAAA;MACA;IACA;MACA,KAAAC,OAAA,CAAAC,IAAA;QAAAC,IAAA;MAAA;MACA,KAAAtB,UAAA;IACA;IACA;IACA;IACA;EAIA;EACAuB,OAAA;IACA,MAAAV,UAAAW,GAAA,EAAAC,MAAA;MAEA;QACA,MAAAC,QAAA,SAAA7B,KAAA,CAAA8B,GAAA,gDAAAH,GAAA;UACAI,OAAA;YACA;YACA,2BAAAH,MAAA;UACA;QACA;QACAjB,OAAA,CAAAC,GAAA,sBAAAiB,QAAA;QACA;MAEA,SAAAG,KAAA;QACArB,OAAA,CAAAqB,KAAA,cAAAA,KAAA;QACA;QACA,KAAAC,MAAA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA,MAAAD,KAAA;MACA;IACA;IACAE,cAAAC,IAAA;MACA,KAAA/B,UAAA,GAAA+B,IAAA;IACA;IACAF,OAAA;MAEAxB,YAAA,CAAA2B,UAAA;MACA3B,YAAA,CAAA2B,UAAA;MACAhB,MAAA,CAAAC,QAAA,CAAAC,MAAA;IACA;IACA,MAAAe,gBAAAV,GAAA,EAAAC,MAAA;MACAjB,OAAA,CAAAC,GAAA,YAAAgB,MAAA;MACA;QACA,MAAAC,QAAA,SAAA7B,KAAA,CAAA8B,GAAA,iDAAAH,GAAA;UACAI,OAAA;YACA;YACA;UACA;QACA;QACApB,OAAA,CAAAC,GAAA,cAAAE,IAAA,CAAAwB,SAAA,CAAAT,QAAA;;QAEA;QACA;;QAEA;QACA;UAAAU,KAAA;UAAAC,YAAA;UAAAC;QAAA,IAAAZ,QAAA,CAAA3B,IAAA;QAEAS,OAAA,CAAAC,GAAA,YAAA2B,KAAA;QACA5B,OAAA,CAAAC,GAAA,iBAAA4B,YAAA;QACA7B,OAAA,CAAAC,GAAA,cAAA6B,YAAA;;QAEA;QACA;UAAAF,KAAA;UAAAC,YAAA;UAAAC;QAAA;MAEA,SAAAT,KAAA;QACArB,OAAA,CAAAqB,KAAA,cAAAA,KAAA;QACA,MAAAA,KAAA;MACA;IACA;EACA;AACA","ignoreList":[]}]}