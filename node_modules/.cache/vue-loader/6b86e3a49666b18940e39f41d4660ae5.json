{"remainingRequest":"/usr/vue/lezuro_all/node_modules/vue-loader/lib/index.js??vue-loader-options!/usr/vue/lezuro_all/src/components/PhoneCertification.vue?vue&type=script&lang=js","dependencies":[{"path":"/usr/vue/lezuro_all/src/components/PhoneCertification.vue","mtime":1733883871577},{"path":"/usr/vue/lezuro_all/node_modules/cache-loader/dist/cjs.js","mtime":1728542746732},{"path":"/usr/vue/lezuro_all/node_modules/babel-loader/lib/index.js","mtime":1728543112262},{"path":"/usr/vue/lezuro_all/node_modules/cache-loader/dist/cjs.js","mtime":1728542746732},{"path":"/usr/vue/lezuro_all/node_modules/vue-loader/lib/index.js","mtime":1728542748492}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBIZWFkZXIgZnJvbSAiLi9IZWFkZXIudnVlIgppbXBvcnQgWEZvb3RlciBmcm9tICIuL1hGb290ZXIiOwppbXBvcnQgUGhvbmVDZXJ0aWZpY2F0aW9uQ29uZmlybU1vZGFsIGZyb20gIi4vUGhvbmVDZXJ0aWZpY2F0aW9uQ29uZmlybU1vZGFsIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUGhvbmVDZXJ0aWZpY2F0aW9uIiwKICBjb21wb25lbnRzOiB7CiAgICBYRm9vdGVyLAogICAgUGhvbmVDZXJ0aWZpY2F0aW9uQ29uZmlybU1vZGFsLAogICAgSGVhZGVyCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGhvbmVObTogJycsCiAgICAgIGlzTW9kYWxWaXNpYmxlOiBmYWxzZSwKICAgICAgaXNQaG9uZU51bWJlclJlZ2lzdGVyZWQ6IGZhbHNlLCAvLyDtlbjrk5ztj7Ag67KI7Zi46rCAIOuTseuhneuQmOyXiOuKlOyngCDsl6zrtoDrpbwg7KCA7J6lCiAgICAgIHNob3dTbXMgOmZhbHNlLAogICAgICBTTVNObSA6ICcnLAogICAgICBjb25zZmlybVR4dCA6ICfsnbjspp3rsojtmLgg7KCE7IahJywKICAgICAgaXNSZWdpc3RlcmVkIDogbnVsbAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHNlbmRTTVNQaG9uZSgpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyDrsojtmLgg7ZmV7J24IOyalOyyrQogICAgICAgIGNvbnN0IHVzZXJDaGVja1JlcyA9IGF3YWl0IGF4aW9zLmdldCgKICAgICAgICAgIGBodHRwOi8vMTMuMTI0LjYyLjY4OjMwMDAvYXBpL3YxL3VzZXJzL3Bob25lTm0vJHt0aGlzLnBob25lTm19YAogICAgICAgICk7CgogICAgICAgIC8vIOuyiO2YuOqwgCDsobTsnqztlZjrqbQg66qo64us7J2EIOyXtOqzoCDsooXro4wKICAgICAgICBpZiAodXNlckNoZWNrUmVzLmRhdGEpIHsKICAgICAgICAgIHRoaXMub3BlblBob25lQ2VydGlmaWNhdGlvbk1vZGFsKGZhbHNlKTsgLy8g7IOB7YOc66W8IGZhbHNl66GcIOyEpOyglQogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAvLyDrsojtmLjqsIAg7JeG7Jy866m0KDQwNCDsl5Drn6wpIOyduOymneuyiO2YuOulvCDsoITshqEKICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICAgICAgICBwaG9uZU51bWJlcjogdGhpcy5waG9uZU5tLAogICAgICAgICAgICB9OwogICAgICAgICAgICBjb25zdCBzbXNSZXMgPSBhd2FpdCBheGlvcy5wb3N0KAogICAgICAgICAgICAgICJodHRwOi8vMTMuMTI0LjYyLjY4OjMwMDAvYXBpL3YxL3Ntcy9zZW5kIiwKICAgICAgICAgICAgICBwYXJhbXMKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGlmIChzbXNSZXMuZGF0YS5kYXRhLmNvZGUgPT09IDEwMDApIHsKICAgICAgICAgICAgICB0aGlzLnNob3dTbXMgPSB0cnVlOwogICAgICAgICAgICAgIGFsZXJ0KCLsubTsubTsmKTthqHsnLzroZwg7J247Kad67KI7Zi46rCAIOuwnOyGoeuQmOyXiOyKteuLiOuLpC4iKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBhbGVydCgi7J247Kad67KI7Zi4IOuwnOyGoeyXkCDsi6TtjKjtlojsirXri4jri6QuIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKHNtc0Vycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGluIFNNUyBzZW5kaW5nOiIsIHNtc0Vycm9yKTsKICAgICAgICAgICAgYWxlcnQoIuyduOymneuyiO2YuCDsoITshqEg7KSRIOyYpOulmOqwgCDrsJzsg53tlojsirXri4jri6QuIik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGluIHVzZXIgcGhvbmUgY2hlY2s6IiwgZXJyb3IpOwogICAgICAgICAgYWxlcnQoIuuyiO2YuCDtmZXsnbgg7KSRIOyYpOulmOqwgCDrsJzsg53tlojsirXri4jri6QuIik7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgYXN5bmMgY2hlY2tQaG9uZU51bWJlcigpIHsKICAgIGNvbnN0IHBhcmFtcyA9CiAgICAgIHsKICAgICAgICAicGhvbmVOdW1iZXIiOiB0aGlzLnBob25lLAogICAgICAgICJ2ZXJpZmljYXRpb25Db2RlIjogdGhpcy5TTVNObQogICAgICB9OwogICAgICBjb25zdCByZXMgPSBhd2FpdCBheGlvcy5wb3N0KCdodHRwOi8vMTMuMTI0LjYyLjY4OjMwMDAvYXBpL3YxL3Ntcy92ZXJpZnktY29kZScscGFyYW1zKTsKCiAgICAgIGNvbnNvbGUubG9nKCJyZXMgOiA6IDogIiAsIEpTT04uc3RyaW5naWZ5KHJlcykpCiAgICAgIAogICAgICAgLy8g7JiI7IucOiBBUEkg7JqU7LKtIO2bhCDsi6TsoJwg6rKw6rO87JeQIOuUsOudvCDshKTsoJUKCiAgICAgIGlmKHJlcyl7CiAgICAgICAgdGhpcy5pc1JlZ2lzdGVyZWQgPSB0cnVlOwogICAgICB9ZWxzZXsKICAgICAgICB0aGlzLmlzUmVnaXN0ZXJlZCA9IGZhbHNlOwogICAgICB9CgogICAgICB0aGlzLm9wZW5QaG9uZUNlcnRpZmljYXRpb25Nb2RhbCh0aGlzLmlzUmVnaXN0ZXJlZCk7CiAgICAgIC8vIOuqqOuLrCDsl7TquLAg67CPIOyDge2DnCDsoIDsnqUKICAgIH0sCiAgICBvcGVuUGhvbmVDZXJ0aWZpY2F0aW9uTW9kYWwoaXNSZWdpc3RlcmVkKSB7CiAgICAgIHRoaXMuaXNNb2RhbFZpc2libGUgPSB0cnVlOwogICAgICB0aGlzLmlzUGhvbmVOdW1iZXJSZWdpc3RlcmVkID0gaXNSZWdpc3RlcmVkOyAvLyB0cnVlIOuYkOuKlCBmYWxzZeuhnCDtlbjrk5ztj7Ag67KI7Zi4IOyDge2DnCDshKTsoJUKICAgICAgLy8gbG9jYWxTdG9yYWdlLmdldEl0ZW0oInBob25lTm8iKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Bob25lTm8nLCB0aGlzLnBob25lTm0pOwoKICAgIH0sCiAgICBjbG9zZVBob25lQ2VydGlmaWNhdGlvbk1vZGFsKCkgewogICAgICB0aGlzLmlzTW9kYWxWaXNpYmxlID0gZmFsc2U7CiAgICB9LAogICAgbmF2aWdhdGVUb1NpZ251cCgpIHsKICAgICAgaWYodGhpcy5pc1JlZ2lzdGVyZWQgPT09IHRydWUpewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvc2lnbnVwIik7CiAgICAgIH1lbHNlewogICAgICAgIHRoaXMuaXNNb2RhbFZpc2libGUgPSBmYWxzZTsKICAgICAgfQogICAgICAKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["PhoneCertification.vue"],"names":[],"mappings":";AA6BA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"PhoneCertification.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"container-center-horizontal\">\n    <div class=\"signup1-2 screen\">\n      <Header />\n      <div class=\"signup1-wrap\">\n        <div class=\"signup1-wrap-title valign-text-middle pretendard-extra-extra-bold-black-30px\">휴대폰 인증</div>\n        <div class=\"signup1-input-align\">\n          <input type=\"text\" class=\"signup1-input-box pretendard-regular-normal-mountain-mist-20px\" v-model=\"phoneNm\"\n              maxlength=\"11\" :readonly=\"showSms\"\n            placeholder=\"휴대폰 번호 입력해주세요\" />\n\n            <input v-if=\"showSms\" type=\"text\" class=\"signup1-input-box pretendard-regular-normal-mountain-mist-20px\" v-model=\"SMSNm\"\n                    maxlength=\"6\"\n            placeholder=\"인증번호를 입력해주세요\" />\n          <button v-if=\"showSms\" class=\"cert-btn pretendard-extra-extra-bold-white-20px\"\n            @click=\"checkPhoneNumber\">인증하기</button>\n          <button v-else class=\"cert-btn pretendard-extra-extra-bold-white-20px\"\n            @click=\"sendSMSPhone\">인증번호 전송</button>\n           \n        </div>\n      </div>\n      <XFooter />\n      <PhoneCertificationConfirmModal v-if=\"isModalVisible\" :isRegistered=\"isPhoneNumberRegistered\"\n        @close=\"closePhoneCertificationModal\" @confirm=\"navigateToSignup\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport Header from \"./Header.vue\"\nimport XFooter from \"./XFooter\";\nimport PhoneCertificationConfirmModal from \"./PhoneCertificationConfirmModal\";\nimport axios from \"axios\";\n\nexport default {\n  name: \"PhoneCertification\",\n  components: {\n    XFooter,\n    PhoneCertificationConfirmModal,\n    Header\n  },\n  data() {\n    return {\n      phoneNm: '',\n      isModalVisible: false,\n      isPhoneNumberRegistered: false, // 핸드폰 번호가 등록되었는지 여부를 저장\n      showSms :false,\n      SMSNm : '',\n      consfirmTxt : '인증번호 전송',\n      isRegistered : null\n    };\n  },\n  methods: {\n    async sendSMSPhone() {\n      try {\n        // 번호 확인 요청\n        const userCheckRes = await axios.get(\n          `http://13.124.62.68:3000/api/v1/users/phoneNm/${this.phoneNm}`\n        );\n\n        // 번호가 존재하면 모달을 열고 종료\n        if (userCheckRes.data) {\n          this.openPhoneCertificationModal(false); // 상태를 false로 설정\n          return;\n        }\n      } catch (error) {\n        // 번호가 없으면(404 에러) 인증번호를 전송\n        if (error.response && error.response.status === 404) {\n          try {\n            const params = {\n              phoneNumber: this.phoneNm,\n            };\n            const smsRes = await axios.post(\n              \"http://13.124.62.68:3000/api/v1/sms/send\",\n              params\n            );\n\n            if (smsRes.data.data.code === 1000) {\n              this.showSms = true;\n              alert(\"카카오톡으로 인증번호가 발송되었습니다.\");\n            } else {\n              alert(\"인증번호 발송에 실패했습니다.\");\n            }\n          } catch (smsError) {\n            console.error(\"Error in SMS sending:\", smsError);\n            alert(\"인증번호 전송 중 오류가 발생했습니다.\");\n          }\n        } else {\n          console.error(\"Error in user phone check:\", error);\n          alert(\"번호 확인 중 오류가 발생했습니다.\");\n        }\n      }\n    },\n\n   async checkPhoneNumber() {\n    const params =\n      {\n        \"phoneNumber\": this.phone,\n        \"verificationCode\": this.SMSNm\n      };\n      const res = await axios.post('http://13.124.62.68:3000/api/v1/sms/verify-code',params);\n\n      console.log(\"res : : : \" , JSON.stringify(res))\n      \n       // 예시: API 요청 후 실제 결과에 따라 설정\n\n      if(res){\n        this.isRegistered = true;\n      }else{\n        this.isRegistered = false;\n      }\n\n      this.openPhoneCertificationModal(this.isRegistered);\n      // 모달 열기 및 상태 저장\n    },\n    openPhoneCertificationModal(isRegistered) {\n      this.isModalVisible = true;\n      this.isPhoneNumberRegistered = isRegistered; // true 또는 false로 핸드폰 번호 상태 설정\n      // localStorage.getItem(\"phoneNo\");\n      localStorage.setItem('phoneNo', this.phoneNm);\n\n    },\n    closePhoneCertificationModal() {\n      this.isModalVisible = false;\n    },\n    navigateToSignup() {\n      if(this.isRegistered === true){\n        this.$router.push(\"/signup\");\n      }else{\n        this.isModalVisible = false;\n      }\n      \n    },\n  },\n};\n</script>\n\n<style scoped src=\"@/style/signup/phonecertification.css\" />"]}]}